# Code Quality Tools

æœ¬é¡¹ç›®é›†æˆäº†ä»¥ä¸‹ä»£ç è´¨é‡æ£€æŸ¥å·¥å…·ï¼š

## ğŸ” å·¥å…·æ¦‚è¿°

### Detekt
- **ç”¨é€”**: Kotlin é™æ€ä»£ç åˆ†æå·¥å…·
- **åŠŸèƒ½**: æ£€æµ‹ä»£ç å¤æ‚åº¦ã€æ½œåœ¨é—®é¢˜ã€ä»£ç å¼‚å‘³ç­‰
- **é…ç½®æ–‡ä»¶**: `config/detekt/detekt.yml`

### ktlint
- **ç”¨é€”**: Kotlin ä»£ç é£æ ¼æ£€æŸ¥å’Œæ ¼å¼åŒ–å·¥å…·
- **åŠŸèƒ½**: å¼ºåˆ¶æ‰§è¡Œ Kotlin å®˜æ–¹ä»£ç é£æ ¼è§„èŒƒ
- **é…ç½®æ–‡ä»¶**: `.ktlint.conf`, `.editorconfig`

## ğŸš€ æœ¬åœ°ä½¿ç”¨

### è¿è¡Œä»£ç æ£€æŸ¥
```bash
# è¿è¡Œ detekt æ£€æŸ¥
./gradlew detekt

# è¿è¡Œ ktlint æ£€æŸ¥
./gradlew ktlintCheck

# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
./gradlew check
```

### ä¿®å¤ä»£ç é£æ ¼é—®é¢˜
```bash
# è‡ªåŠ¨ä¿®å¤ ktlint å‘ç°çš„æ ¼å¼é—®é¢˜
./gradlew ktlintFormat
```

### æŸ¥çœ‹æŠ¥å‘Š
æ£€æŸ¥å®Œæˆåï¼ŒæŠ¥å‘Šä¼šç”Ÿæˆåœ¨ä»¥ä¸‹ä½ç½®ï¼š
- **Detekt**: `app/build/reports/detekt/`
- **ktlint**: `app/build/reports/ktlint/`

## ğŸ¤– CI/CD é›†æˆ

### GitHub Actions
é¡¹ç›®é…ç½®äº† GitHub Actions å·¥ä½œæµ (`.github/workflows/ci.yml`)ï¼Œä¼šåœ¨ä»¥ä¸‹æƒ…å†µè‡ªåŠ¨è¿è¡Œï¼š
- Push åˆ° `main` åˆ†æ”¯
- åˆ›å»º Pull Request åˆ° `main` åˆ†æ”¯
- æ‰‹åŠ¨è§¦å‘

### å·¥ä½œæµæ­¥éª¤
1. **ä»£ç è´¨é‡æ£€æŸ¥** (Ubuntu)
   - âœ… è¿è¡Œ detekt é™æ€åˆ†æ
   - âœ… è¿è¡Œ ktlint ä»£ç é£æ ¼æ£€æŸ¥
   - âœ… æ„å»º debug APK éªŒè¯ç¼–è¯‘
   - ğŸ“Š ä¸Šä¼ æŠ¥å‘Šæ–‡ä»¶
   - ğŸ’¬ åœ¨ PR ä¸­è¯„è®ºç»“æœ

2. **Android CI** (Windows self-hosted)
   - ä»…åœ¨ä»£ç è´¨é‡æ£€æŸ¥é€šè¿‡åè¿è¡Œ
   - æ‰§è¡Œå®Œæ•´çš„ Android æ„å»ºå’Œæµ‹è¯•

### PR æ£€æŸ¥
æ¯ä¸ª Pull Request éƒ½ä¼šè‡ªåŠ¨è§¦å‘æ£€æŸ¥ï¼Œç¡®ä¿ï¼š
- ä»£ç ç¬¦åˆé¡¹ç›®é£æ ¼è§„èŒƒ
- æ²¡æœ‰é™æ€åˆ†æè­¦å‘Š
- ä»£ç èƒ½å¤ŸæˆåŠŸç¼–è¯‘

## âš™ï¸ é…ç½®è¯´æ˜

### Detekt é…ç½®
ä¸»é…ç½®æ–‡ä»¶ï¼š`config/detekt/detekt.yml`
- åŸºäºé»˜è®¤é…ç½®æ„å»º
- å¯ç”¨æ ¼å¼åŒ–è§„åˆ™
- ç”Ÿæˆå¤šç§æ ¼å¼æŠ¥å‘Š (HTML, XML, TXT, SARIF, MD)
- å¯¹æµ‹è¯•æ–‡ä»¶æœ‰ç‰¹æ®Šè§„åˆ™

### ktlint é…ç½®
é…ç½®æ–‡ä»¶ï¼š`.ktlint.conf` å’Œ `.editorconfig`
- å¯ç”¨ Android å…¼å®¹æ¨¡å¼
- æœ€å¤§è¡Œé•¿åº¦ï¼š120 å­—ç¬¦
- ç¼©è¿›ï¼š4 ä¸ªç©ºæ ¼
- ç”Ÿæˆå¤šç§æ ¼å¼æŠ¥å‘Š

### IDE é›†æˆ
æ¨èåœ¨ IDE ä¸­å®‰è£…ç›¸åº”æ’ä»¶ï¼š
- **Android Studio/IntelliJ**: detekt æ’ä»¶
- **VS Code**: Kotlin æ’ä»¶ + ktlint æ‰©å±•

## ğŸ› ï¸ è‡ªå®šä¹‰è§„åˆ™

### ç¦ç”¨ç‰¹å®šè§„åˆ™
åœ¨ `detekt.yml` ä¸­è®¾ç½®ï¼š
```yaml
rule-set:
  RuleName:
    active: false
```

åœ¨ä»£ç ä¸­ä½¿ç”¨æ³¨è§£ï¼š
```kotlin
@Suppress("RuleName")
class MyClass
```

### æ’é™¤æ–‡ä»¶
åœ¨é…ç½®æ–‡ä»¶çš„ `excludes` éƒ¨åˆ†æ·»åŠ è·¯å¾„æ¨¡å¼ï¼š
```yaml
excludes: ['**/generated/**', '**/test/**']
```

## ğŸ“ˆ æŠ¥å‘ŠæŸ¥çœ‹

### æœ¬åœ°æŠ¥å‘Š
- HTML æŠ¥å‘Šï¼šæµè§ˆå™¨ä¸­æ‰“å¼€ `app/build/reports/detekt/detekt.html`
- æ§åˆ¶å°è¾“å‡ºï¼šç›´æ¥åœ¨ç»ˆç«¯æŸ¥çœ‹ç»“æœ

### CI æŠ¥å‘Š
- GitHub Actions ä¼šä¸Šä¼ æŠ¥å‘Šä½œä¸ºå·¥ä»¶
- å¯ä»¥åœ¨ Actions é¡µé¢ä¸‹è½½æŸ¥çœ‹
- PR ä¼šæ”¶åˆ°è‡ªåŠ¨è¯„è®ºæ±‡æ€»ç»“æœ

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æ„å»ºå¤±è´¥**: æ£€æŸ¥æ˜¯å¦æœ‰ä»£ç é£æ ¼è¿è§„
2. **å†…å­˜ä¸è¶³**: å¢åŠ  gradle.properties ä¸­çš„å†…å­˜è®¾ç½®
3. **æ’ä»¶ç‰ˆæœ¬å†²çª**: ç¡®ä¿ç‰ˆæœ¬ç›®å½•æ–‡ä»¶ `libs.versions.toml` ä¸­çš„ç‰ˆæœ¬ä¸€è‡´

### ä¸´æ—¶è·³è¿‡æ£€æŸ¥
```bash
# è·³è¿‡ detekt
./gradlew build -x detekt

# è·³è¿‡ ktlint
./gradlew build -x ktlintCheck
```

## ğŸ“ æœ€ä½³å®è·µ

1. **æäº¤å‰æ£€æŸ¥**: å§‹ç»ˆåœ¨æäº¤å‰è¿è¡Œ `./gradlew check`
2. **å¢é‡ä¿®å¤**: é€æ­¥ä¿®å¤ç°æœ‰ä»£ç çš„é—®é¢˜ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å…¨éƒ¨ä¿®å¤
3. **å›¢é˜Ÿçº¦å®š**: å›¢é˜Ÿæˆå‘˜åº”å°±ä»£ç é£æ ¼è¾¾æˆä¸€è‡´
4. **æŒç»­æ”¹è¿›**: å®šæœŸå®¡æŸ¥å’Œæ›´æ–°è§„åˆ™é…ç½®

## ğŸ”— ç›¸å…³é“¾æ¥

- [Detekt å®˜æ–¹æ–‡æ¡£](https://detekt.dev/)
- [ktlint å®˜æ–¹æ–‡æ¡£](https://pinterest.github.io/ktlint/)
- [Kotlin ç¼–ç è§„èŒƒ](https://kotlinlang.org/docs/coding-conventions.html)